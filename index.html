<!DOCTYPE html>
<html>
<head>
  <title>Visitor Logger with ProxyCheck</title>
</head>
<body>
  <h2>Welcome!</h2>
  <p>Your visit has been logged (if not using VPN/proxy).</p>

  <script>
    const webhookURL = "YOUR_DISCORD_WEBHOOK_URL_HERE"; // Replace with your webhook
    const proxyCheckAPIKey = "7738y5-n443d7-p72755-811973";

    fetch("https://ipinfo.io/json")
      .then(res => res.json())
      .then(ipData => {
        const ip = ipData.ip;

        fetch(`https://proxycheck.io/v2/${ip}?key=${proxyCheckAPIKey}&vpn=1&asn=1&risk=1`)
          .then(res => res.json())
          .then(proxyData => {
            if (proxyData.status === "error") {
              throw new Error(proxyData.message || "Unknown ProxyCheck error");
            }

            const ipInfo = proxyData[ip];
            if (!ipInfo) {
              throw new Error("No data for IP");
            }

            if (ipInfo.proxy === "yes") {
              showAccessDenied("Access Denied: VPN or Proxy detected.");
              return;
            }

            const message = {
              content: `🔍 New Visitor Logged:\nIP: ${ip}\nCity: ${ipData.city}\nRegion: ${ipData.region}\nCountry: ${ipData.country}\nISP: ${ipInfo.asn_org || "Unknown"}`
            };

            fetch(webhookURL, {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(message)
            }).catch(console.error);
          })
          .catch(err => {
            console.error("ProxyCheck API error:", err);
            showAccessDenied("Error verifying proxy status.");
          });
      })
      .catch(err => {
        console.error("IP info error:", err);
        showAccessDenied("Error fetching IP info.");
      });

    function showAccessDenied(msg) {
      document.body.innerHTML = `<h2 style="color: red;">${msg}</h2>`;
    }
  </script>
</body>
</html>
